# flatten.ys

# 1. 讀入 Verilog 檔案，啟用 SystemVerilog 語法解析
read_verilog -sv trojan0.v

# 2. 驗證階層並指定頂層模組
hierarchy -check -top Trojan0

# 3. 展開 procedural blocks（for-loop 會自動轉成 state machine）
proc

# 4. 扁平化指定頂層底下的所有子模組
flatten -selected Trojan0

# 5. 清除未使用的 wire/reg
opt_clean

# 6. 輸出扁平後的單層 netlist
write_verilog flattened_trojan0.v
